name: "reusable flow: Deploy Storybook"

on:
    workflow_call:
        inputs:
            branch:
                type: string
                required: false
                default: master
        secrets:
            githubActor:
                required: true
            githubToken:
                required: true

jobs:
    build-publish:
        name: Build & Publish
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@master

            - uses: actions/setup-node@master
              with:
                node-version: ${{ inputs.node-version }}
                cache: 'yarn'

            - name: Install dependencies
              run: yarn --frozen-lockfile

            - name: Build Storybook
              run: yarn build-storybook --output-dir storybook-static/${{ inputs.branch }}

            - name: Publish Storybook
              uses: JamesIves/github-pages-deploy-action@v4
              with:
                FOLDER: storybook-static
